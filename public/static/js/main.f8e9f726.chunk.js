(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{113:function(e,t){},116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){},119:function(e,t,n){},120:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){},128:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(60),i=n.n(s),c=(n(68),n(19)),o=n(20),l=n(23),m=n(21),u=(n(69),n(18)),d=n(1),E=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Codebreaker!"))},h=n(33),v=n.n(h);v.a.defaults.proxy={host:"localhost",port:3001};var f=function(){var e=Object(d.f)();return r.a.createElement("button",{onClick:function(){v.a.get("/new").then((function(t){e.push("/game/".concat(t.data))})).catch((function(e){return console.error(e)}))}},"Start New Game")},p=(n(90),function(e){var t=e.player;return r.a.createElement("div",null,r.a.createElement("div",{className:"player"},r.a.createElement("div",{className:"name"},t.name),r.a.createElement("span",{className:["dot","connected"===t.status?"connected":"disconnected"].join(" ")})))}),y=function(e){var t=e.players;return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:2},"Players"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement(p,{player:e}))}))))},b=function(e){var t=e.players.find((function(t){return t.id===e.myId}));if(void 0===t)throw new Error("Me no exist");var n=e.players.length>3&&e.players.every((function(e){return""!==e.name}));return r.a.createElement("div",null,r.a.createElement("h3",null,"Waiting for players to join..."),r.a.createElement("p",null,"Game link:",r.a.createElement("input",{disabled:!0,value:window.location.href,style:{width:"500px"}})),r.a.createElement("p",null,"Please enter your name:"," ",r.a.createElement("input",{value:t.name,onChange:function(t){return e.onNameChange(t.target.value)}})),r.a.createElement(y,{players:e.players}),r.a.createElement("button",{disabled:!n,onClick:e.onGameStart},"Start the Game!"),r.a.createElement("p",null,"(You need 4 players to start)"))},g=n(61),N=n.n(g),w=(n(116),function(e){var t=e.cypher,n=[0,1,2,3];return r.a.createElement("div",{className:"cypher"},r.a.createElement("div",{className:"cypherTitle"},"Your Team","'","s Cypher"),r.a.createElement("div",{className:"cypherRow"},n.map((function(e){return r.a.createElement("div",{className:"cypherIndex cypherRowItem",key:e},"".concat(e+1))}))),r.a.createElement("div",{className:"cypherRow"},n.map((function(e){return r.a.createElement("div",{className:"cypherWord cypherRowItem",key:e},t[e])}))))}),T=(n(117),function(e){var t=e.transmissions.map((function(e){var t=e.code,n=e.transmission,a=t,r=[a.findIndex((function(e){return 1===e})),a.findIndex((function(e){return 2===e})),a.findIndex((function(e){return 3===e})),a.findIndex((function(e){return 4===e}))];return[-1!==r[0]?n[r[0]]:"",-1!==r[1]?n[r[1]]:"",-1!==r[2]?n[r[2]]:"",-1!==r[3]?n[r[3]]:""]})),n=[0,1,2,3];return r.a.createElement("div",{className:"transmissionHistory"},r.a.createElement("div",{className:"historyTitle"},"Transmission history"),r.a.createElement("div",{className:"historyRow"},n.map((function(e){return r.a.createElement("div",{className:"historyIndex historyRowItem",key:e},"".concat(e+1))}))),t.map((function(e,t){return r.a.createElement("div",{key:t,className:"historyRow"},n.map((function(t){return r.a.createElement("div",{className:"".concat(""===e[t]?"":"historyEntry"," historyRowItem"),key:t},e[t])})))})))}),k=n(7),S=(n(118),n(119),function(e){var t=e.data;return r.a.createElement("div",{className:"code"},"[",t.join(", "),"]")}),I=function(e){var t=e.code,n=e.onSend,s=Object(a.useState)(""),i=Object(k.a)(s,2),c=i[0],o=i[1],l=Object(a.useState)(""),m=Object(k.a)(l,2),u=m[0],d=m[1],E=Object(a.useState)(""),h=Object(k.a)(E,2),v=h[0],f=h[1],p=[{code:t[0],setter:o},{code:t[1],setter:d},{code:t[2],setter:f}],y=""!==c&&""!==u&&""!==v;return r.a.createElement("div",{className:"transmission"},r.a.createElement("div",{className:"title transRow"},"Code:",r.a.createElement(S,{data:t})),r.a.createElement("div",{className:"transRows"},p.map((function(e,t){var n=e.code,a=e.setter;return r.a.createElement("div",{className:"transRow",key:t},r.a.createElement("div",{className:"codeDigit"},n),r.a.createElement("input",{className:"digitEncoding",onChange:function(e){return a(e.target.value)}}))}))),r.a.createElement("div",{className:"transRow"},r.a.createElement("button",{className:"button",id:"send",onClick:function(){return n([c,u,v])},disabled:!y},"Transmit")))},O=(n(120),function(e){var t=e.transmission,n=e.onGuess,s=Object(a.useState)(void 0),i=Object(k.a)(s,2),c=i[0],o=i[1],l=Object(a.useState)(void 0),m=Object(k.a)(l,2),u=m[0],d=m[1],E=Object(a.useState)(void 0),h=Object(k.a)(E,2),v=h[0],f=h[1],p=function(e){return function(t){var n=Number(t.target.value);isNaN(n)?e(void 0):e(n)}},y=[{transmission:t[0],setter:p(o)},{transmission:t[1],setter:p(d)},{transmission:t[2],setter:p(f)}],b=function(e){return void 0!==e&&(e>0&&e<=4)},g=b(c)&&b(u)&&b(v);return r.a.createElement("div",{className:"transmission"},r.a.createElement("div",{className:"title transRow"},"Transmission:",r.a.createElement(S,{data:t})),r.a.createElement("div",{className:"transRows"},y.map((function(e,t){var n=e.transmission,a=e.setter;return r.a.createElement("div",{className:"transRow",key:t},r.a.createElement("div",{className:"transmissionElement"},n),r.a.createElement("input",{className:"codeEntry",onChange:a}))}))),r.a.createElement("div",{className:"transRow"},r.a.createElement("button",{className:"button",id:"send",onClick:function(){return n([c,u,v])},disabled:!g},"Decrypt Code")))}),C=(n(121),function(e){var t=e.code,n=e.transmission;return r.a.createElement("div",{className:"transSentSub"},r.a.createElement("div",{className:"transSentSubRow"},"Code was:",r.a.createElement(S,{data:t})),r.a.createElement("div",{className:"transSentSubRow"},"You transmitted:",r.a.createElement(S,{data:n})))}),R=(n(122),function(){return r.a.createElement("div",{className:"waitingForTransmission"},"Waiting for transmission...")}),G=(n(123),function(e){var t=e.guess,n=e.transmission;return r.a.createElement("div",{className:"guessSub"},r.a.createElement("div",{className:"guessSubRow"},"Transmission was: ",r.a.createElement(S,{data:n})),r.a.createElement("div",{className:"guessSubRow"},"Your team submitted code: ",r.a.createElement(S,{data:t})))}),j=(n(124),n(36)),x=(n(125),function(e){var t,n=e.code,a=e.transmission,s=e.guesses,i=e.transmitterTeam,c=e.onEndTurn,o="red"===i?"blue":"red",l=JSON.stringify(s[o])===JSON.stringify(n),m=JSON.stringify(s[i])!==JSON.stringify(n),u=(t={},Object(j.a)(t,i,m?r.a.createElement("div",{className:"resultTransFail resultShared"},"Transmission Failure"):void 0),Object(j.a)(t,o,l?r.a.createElement("div",{className:"resultInterception resultShared"},"Interception"):void 0),t);return r.a.createElement("div",{className:"resultMain"},r.a.createElement("div",null,"The code was ",r.a.createElement(S,{data:n})),r.a.createElement("div",null,"The ",i," team transmitted ",r.a.createElement(S,{data:a})),["red","blue"].map((function(e){return r.a.createElement("div",{key:e},"The ",e," team guessed ",r.a.createElement(S,{data:s[e]}),u[e])})),r.a.createElement("div",{className:"resultEndRow"},r.a.createElement("button",{className:"resultEndTurn",onClick:c},"End Turn")))}),M=function(e){var t,n=e.game,a=e.team,s=e.me,i=e.onTransmit,c=e.onGuess,o=e.onEndTurn,l=n.history[n.history.length-1],m=function(e,t,n){return"COMPLETE"===e.type?"VIEWING_RESULTS":e.encryptor===t?void 0===e.transmission?"TRANSMITTING":"TRANSMITTED":void 0===e.transmission?"WAITING":void 0===e.guesses||void 0===e.guesses[n]?"GUESSING":"GUESSED"}(l,s,a);if("TRANSMITTING"===m)t=r.a.createElement(I,{code:l.code,onSend:i});else if("TRANSMITTED"===m)t=r.a.createElement(C,{transmission:l.transmission,code:l.code});else if("WAITING"===m)t=r.a.createElement(R,null);else if("GUESSING"===m)t=r.a.createElement(O,{transmission:l.transmission,onGuess:c});else if("GUESSED"===m){var u=l.guesses;if(void 0===u)throw new Error("Status guessed but no guesses exist");t=r.a.createElement(G,{transmission:l.transmission,guess:u[a]})}else if("VIEWING_RESULTS"===m){var d=l.guesses,E=l.code;t=r.a.createElement(x,{code:E,transmission:l.transmission,guesses:d,transmitterTeam:l.encryptorTeam,onEndTurn:o})}var h=n.history.filter((function(e){return"COMPLETE"===e.type&&e.encryptorTeam===a}));return r.a.createElement("div",null,r.a.createElement("div",{className:"teamTitle ".concat(a,"Team")},"You are on the ",a," team!"),r.a.createElement(w,{cypher:n[a].cypher}),t,r.a.createElement(T,{transmissions:h}))},W=function(e){var t=e.game,n=e.team,a=t.history.filter((function(e){return"COMPLETE"===e.type&&e.encryptorTeam===n}));return r.a.createElement("div",null,r.a.createElement("div",{className:"teamTitle ".concat(n,"Team")},"The ",n," team"),r.a.createElement(T,{transmissions:a}))},D=function(e){var t=e.game;return r.a.createElement("div",null,r.a.createElement("h3",null,"Game Status:"),r.a.createElement("p",null,"Turn: ",Math.floor(t.history.length/2)+1),r.a.createElement("p",null,"Interceptions: (Red: ",t.red.interceptions,") (Blue:"," ",t.blue.interceptions,")"),r.a.createElement("p",null,"Failed Transmissions: (Red: ",t.red.transmission_fails,") (Blue:"," ",t.blue.transmission_fails,")"))},L=(n(126),function(e){var t=e.game,n=e.myId,a=e.onTransmit,s=e.onTeamGuess,i=e.onEndTurn,c=t.red.players.find((function(e){return e===n}))?"red":"blue",o="red"===c?"blue":"red";return r.a.createElement("div",{className:"parent"},r.a.createElement("div",{className:"mainPanel"},r.a.createElement(M,{me:n,game:t,team:c,onGuess:function(e){return s(c,e)},onTransmit:a,onEndTurn:i})),r.a.createElement("div",{className:"mainPanel"},r.a.createElement(W,{team:o,game:t})),r.a.createElement("div",{className:"sidePanel"},r.a.createElement(D,{game:t}),r.a.createElement(y,{players:t.players})))}),P=function(e){var t=e.winner;return"draw"===t?r.a.createElement("div",null,r.a.createElement("h2",null,"Draw!")):r.a.createElement("div",null,r.a.createElement("h2",null,"The ",t," team has won the game!"))},U=n(129),A=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){var a;Object(c.a)(this,n),(a=t.call(this,e)).socket=void 0;var r=a.props.cookies.get("codebreaker-player-id");return a.state={myId:void 0===r?"pending":r,gameId:a.props.match.params.id,game:"pending"},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.socket=N()({query:{gameId:this.state.gameId,userId:this.state.myId}}),window.addEventListener("beforeunload",this.componentCleanup),this.socket.on("welcome",(function(t){e.props.cookies.set("codebreaker-player-id",t.id),e.setState({myId:t.id})})),this.socket.on("game state",(function(t){e.setState({game:t})}))}},{key:"componentWillUnmount",value:function(){this.componentCleanup(),window.removeEventListener("beforeunload",this.componentCleanup)}},{key:"componentCleanup",value:function(){if(void 0===this.socket)throw new Error("No socket connection when unmounting");this.socket.emit("disconnect"),this.socket.disconnect(),this.socket.close()}},{key:"onNameChange",value:function(e){if(void 0===this.socket)throw new Error("Callback called before socket connection established");this.socket.emit("player name",e)}},{key:"onGameStart",value:function(){if(void 0===this.socket)throw new Error("Callback called before socket connection established");this.socket.emit("start game")}},{key:"onEndTurn",value:function(){if(void 0===this.socket)throw new Error("Callback called before socket connection established");this.socket.emit("end turn")}},{key:"onTeamGuess",value:function(e,t){if(void 0===this.socket)throw new Error("Callback called before socket connection established");this.socket.emit("guess",{team:e,guess:t})}},{key:"onTransmit",value:function(e){if(void 0===this.socket)throw new Error("Callback called before socket connection established");this.socket.emit("transmission",e)}},{key:"render",value:function(){var e,t=this;return void 0===this.socket||"pending"===this.state.myId||"pending"===this.state.game||-1===this.state.game.players.findIndex((function(e){return e.id===t.state.myId}))?e=r.a.createElement("div",null,"Connecting ..."):"LOBBY"===this.state.game.state?e=r.a.createElement(b,{players:this.state.game.players,myId:this.state.myId,onNameChange:this.onNameChange.bind(this),onGameStart:this.onGameStart.bind(this)}):"RUNNING"===this.state.game.state?e=r.a.createElement(L,{game:this.state.game,myId:this.state.myId,onTeamGuess:this.onTeamGuess.bind(this),onTransmit:this.onTransmit.bind(this),onEndTurn:this.onEndTurn.bind(this)}):"FINISHED"===this.state.game.state&&(e=r.a.createElement(P,{winner:this.state.game.winner})),r.a.createElement("div",null,e)}}]),n}(r.a.Component),B=Object(U.a)(Object(d.g)(A)),J=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement(u.a,null,r.a.createElement(E,null),r.a.createElement(d.c,null,r.a.createElement(d.a,{exact:!0,path:"/"},r.a.createElement(f,null)),r.a.createElement(d.a,{path:"/game/:id"},r.a.createElement(B,null))))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(127);var Y=n(130);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Y.a,null,r.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},63:function(e,t,n){e.exports=n(128)},68:function(e,t,n){},69:function(e,t,n){},90:function(e,t,n){}},[[63,1,2]]]);
//# sourceMappingURL=main.f8e9f726.chunk.js.map